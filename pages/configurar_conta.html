<!DOCTYPE html>
<html>

<head>
    <title>Facebook Manager</title>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="../css/photon.css">
    <link rel="stylesheet" href="../css/style.css">

</head>

<body>
    <div class="window">

        <header class="toolbar toolbar-header">
            <h1 class="title"><strong>Configurar Conta</strong></h1>

            <div class="toolbar-actions">

                <div class="btn-group">
                    <a class="btn btn-default" id="homeBtn" href="../index.html">
                        <span class="icon icon-home icon-text"></span>home
                    </a>
                </div>

                <div class="btn-group">
                    <a class="btn btn-default" href="#">
                        <span class="icon icon-user-add icon-text"></span>adicionar conta
                    </a>
                </div>
            </div>
        </header>

        <div class="window-content">
            <div class="pane-group">
                <div class="pane text-center" id="app" v-cloak>

                    <form action="#">

                        <div class="checkbox">
                            <label>
                                <input id="doisFatores" type="checkbox"> Fazer Login Manual( verificação dois fatores)
                            </label>
                        </div> 

                        <div class="checkbox">
                            <label>
                                <input v-on:click="showFormat" id="baixarInformacoes" type="checkbox"> Baixar informações no inicio

                                <div v-if="showFormatDiv">
                                    <div class="radio">
                                        <label>
                                            <input type="radio" value="JSON" name="formato" checked>
                                            JSON
                                        </label>
                                    </div>
                                    <div class="radio">
                                        <label>
                                            <input type="radio" value="HTML" name="formato">
                                            HTML
                                        </label>
                                    </div>
                                </div>

                            </label>
                        </div>

                        <div class="checkbox">
                            <label>
                                <input id="deletarAtividade" type="checkbox"> Deletar Fotos
                            </label>
                        </div>

                        <div class="checkbox">
                            <label>
                                <input id="deletarAlbuns" type="checkbox"> Deletar Álbuns
                            </label>
                        </div>


                        <div class="checkbox">
                            <label>
                                <input id="alterarPrivacidade" type="checkbox"> Alterar definições de privacidade
                            </label>
                        </div>

                        <div class="checkbox">
                            <label>
                                <input id="excluirMensagens" type="checkbox"> Excluir todas as mensagens ?
                            </label>
                        </div>

                        <div class="form-actions">
                            
                            <button v-on:click="analisarRespostas" id="iniciarConfig" class="btn btn-form btn-primary">iniciar</button>

                            <button v-on:click="cancelarConfig" id="cancelarConfig" class="btn btn-form btn-negative">cancelar</button>

                          </div>
                    </form>

                </div>
            </div>
        </div>
        <script src="../js/vue.min.js"></script>
</body>

<script>
    var app = new Vue({
      el: '#app',
      data: {
        showFormatDiv:false,
        options:{},
        db: require('../renderer.js'),
        api: require('../engine/configureAccount.js'),

      },
      methods: {
          qs: (selector)=> {
            return document.querySelector(selector)
          },
          qsAll:(selector)=> {
            return document.querySelectorAll(selector)
          },
          showFormat: (e)=>{
            if(e.target.checked){
                app.showFormatDiv = true
            }else {
                app.showFormatDiv = false
            }  
          },
          analisarRespostas: (e) => {
            e.preventDefault()
            if( app.options.login ){
                app.options.openNewPage = true
            }else {
                app.options.login = {}
                app.options.login.email = app.db.get('session').get('email').value()
                app.options.login.password = app.db.get('session').get('senha').value()
            }

            app.options.headless = false   
            if( app.qs('#doisFatores').checked ){
                app.options.login.twoFactors = true
            }

            if( app.qs('#baixarInformacoes').checked ){

               app.options.downloadInformation = {}

               for (const formatOpt of app.qsAll('[name="formato"]')) {
                    if( formatOpt.checked ){
                        app.options.downloadInformation.format = formatOpt.value
                    }
               }
                
            }

            if( app.qs('#alterarPrivacidade').checked ){
                app.options.changePrivacity = true
            }

            // if( app.qs('#excluirFotosVideos').checked ){
            //    app.options.deletePhotosVideos = true
            // }

            if( app.qs('#excluirMensagens').checked ){
                app.options.deleteAllMessages = true  
            }
            if( app.qs('#deletarAtividade').checked ){
                app.options.deleteActivityPhotos = true  
            }
            if(app.qs('#deletarAlbuns').checked){
                app.options.deleteAlbuns = true
            }
            
            console.log( app.options )
            app.api(app.options)
          },
          cancelarConfig: (e) => {
              e.preventDefault()
              document.querySelector('#homeBtn').click()
          }
      }
    })
  </script>

</html>